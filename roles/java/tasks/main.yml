- name: Import OS vars
  ansible.builtin.include_vars: "{{ ansible_os_family }}.yml"

- name: Debian 12 nonfree repos
  when: ansible_distribution == 'Debian' and ansible_distribution_major_version == '12'
  block:
    - name: Add nonfree repos
      ansible.builtin.copy:
        dest: /etc/apt/sources.list.d/nonfree.list
        content: |
          deb http://deb.debian.org/debian {{ ansible_distribution_release | default('stable') }} main non-free contrib
          {% if ansible_distribution_release == 'bookworm' %}
          deb http://deb.debian.org/debian sid main non-free contrib
          {% endif %}

    - name: Apt update
      ansible.builtin.apt:
        update_cache: true

- name: Install Java
  ansible.builtin.package:
    name: "{{ java_pkg }}"
    state: present
  when:
    - java_pkg is defined

# code: language=ansible
